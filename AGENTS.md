# AGENTS

This repo uses GitHub Actions as autonomous agents to keep Zcash Radio updated and deployed.  
They handle two roles: **Scanner Agent** and **Deployment Agent**.

---

## Scanner Agent

**Purpose:** Periodically scan the Zcash Community Forum “What are you listening to?” thread and produce an up-to-date `videos.json`.

 - **Codebase:** [Rust scanner crate at repo root](./)
- **Language:** Rust
- **Entry point:** `src/main.rs`
- **Behavior:**
  1. Fetch the topic JSON from Discourse (`print=true`).
  2. Parse each post’s HTML for YouTube links.
  3. Normalize to canonical video IDs.
  4. Deduplicate and overwrite `public/videos.json`.
  5. Attach metadata for each video: source post URL, posting username, and optional tip fields.
  6. Look up each poster’s Discourse profile for a Zcash Unified Address, cache it for 24 hours in `target/profile_cache/`, and record it only if it is a mainnet address without transparent receivers.

**Trigger:** Runs inside the `build` job of the GitHub Actions workflow.

---

## Deployment Agent

**Purpose:** Publish the static site (`public/`) to GitHub Pages with the freshest playlist.

- **Static site:** [`public/index.html`](./public/index.html)
- **Artifact:** `public/videos.json` (generated by Scanner Agent)
- **Player behavior:** Loads `videos.json`, shuffles, streams fullscreen via YouTube IFrame API.
- **Donation address:** Default fallback is hard-coded in [`public/index.html`](./public/index.html); the player swaps to curator tips from `videos.json` when available.

**Triggering conditions:**
- On every push to `main`.
- On schedule (cron) every 6 hours.
- On manual dispatch.

---

## Workflow Summary

- File: [`.github/workflows/deploy.yml`](.github/workflows/deploy.yml)
- Jobs:
  - **build**
    - Check out repo
    - Run Rust scanner → output `public/videos.json`
    - Upload `public/` as Pages artifact
  - **deploy**
    - Deploy artifact to GitHub Pages

---

## Extending Agents

- **Deny/allow lists:** Add a simple filter layer in the scanner to exclude videos or force include specific IDs.
- **Curated feeds:** Swap the forum thread URL for another Discourse topic or JSON source.
- **Frequency:** Adjust the cron in `deploy.yml` (`0 */6 * * *`) to suit.
